# Git flow

## Типы веток

В Git flow используются следующие типы веток:
- `main`: основная ветка, содержащая стабильный код, и все релизы.
- `develop`: ветка для интеграции новых функций и изменений, которая служит основой для разработки.
- `feature/#<id>`: головные ветки для разработки фич, состоящих из нескольких задач
- `task/#<id>`: рабочие ветки для выполнения конкретных задач и исправления багов
- `release/X.Y.Z`: ветки для подготовки к выпуску новой версии

---

## Нейминг веток

Ветки feature и task должны именоваться в формате: `<type>/#<id>`, где `<type>` - это тип ветки (feature или task), а `<id>` - уникальный идентификатор задачи или функции, связанной с этой веткой. Например:
- `feature/#123`: ветка для разработки новой функции с идентификатором 123
- `task/#456`: рабочая ветка для задачи с идентификатором 456

Релизные ветки должны именоваться в формате: `release/X.Y.Z`, где `X.Y.Z` - номер версии. Например:
- `release/1.0.0`: ветка для подготовки к выпуску версии

---

## Коммиты

Сообщения коммитов должны содержать идентификатор задачи.

Формат:
- `[#<id>] <краткое описание изменений>`

Примеры:
- `[#42] add inventory window`
- `[#87] fix save loading crash`

Правила:
- один коммит — одно логически завершённое изменение

---

## Работа с feature-ветками и рабочими ветками

### Feature-ветка

`feature/#<id>` используется для разработки фичи, которая состоит из нескольких задач.

Feature-ветка является общей головной веткой для разработки фичи и используется всей командой в процессе работы над ней.

Особенности feature-ветки:
- в feature-ветку постепенно попадают результаты выполнения отдельных задач через слияние рабочих веток
- feature-ветка должна **всегда находиться в рабочем и собираемом состоянии**
- перед слиянием рабочей ветки в feature-ветку изменения должны быть проверены на корректность работы
- feature-ветка не предназначена для экспериментов и временно ломающих изменений
- после завершения всех задач по фиче feature-ветка сливается обратно в `develop`

### Рабочая ветка

`task/#<id>` используется для работы над конкретной задачей.

Рабочая ветка всегда имеет чёткую область ответственности и короткий жизненный цикл.

Правила создания рабочей ветки:
- если задача является частью конкретной фичи, рабочая ветка создаётся от соответствующей `feature/#<feature_id>`
- если задача не относится к какой-либо фиче, рабочая ветка создаётся напрямую от `develop`

## Источник веток

- `feature/#<id>` → создаётся от `develop`
- `task/#<id>` → создаётся от `develop` или от соответствующей `feature/#<id>`
- `release/X.Y.Z` → создаётся от `develop`

## Правила слияния веток и ответственности

Для поддержания стабильности основных веток и прозрачности процесса разработки вводятся следующие правила слияния веток.

---

### Слияние рабочих веток в feature-ветку

- Слияние рабочей ветки (`task/#<id>`) в соответствующую `feature/#<id>` выполняет **исполнитель задачи**.
- Исполнитель несёт ответственность за:
    - корректность реализации задачи
    - работоспособность кода
    - отсутствие поломок в feature-ветке
- Перед слиянием рабочая ветка должна быть проверена и находиться в рабочем состоянии.
- Pull Request для слияния рабочей ветки в feature-ветку не обязателен и используется по необходимости.

---

### Слияние рабочих и feature-веток в develop

- Слияние:
    - рабочих веток (`task/#<id>`, созданных напрямую от `develop`)
    - feature-веток (`feature/#<id>`)

  в ветку `develop` выполняет **тимлид**.

- Слияние в `develop` осуществляется **только через Pull Request**.
- Pull Request используется для:
    - финальной проверки изменений
    - контроля качества
    - подтверждения готовности изменений к интеграции

---

### Слияние веток с исправлениями в release-кандидат

- Слияние веток `task/#<id>`, содержащих исправления, предназначенные для релиз-кандидата, в ветку `release/X.Y.Z` выполняет **тимлид**.
- Слияние осуществляется **только через Pull Request**.
- В релизную ветку допускаются только изменения, направленные на:
    - исправление ошибок
    - стабилизацию
    - подготовку к релизу

---

### Слияние релизной ветки

- Слияние ветки `release/X.Y.Z`:
    - в `main`
    - и обратно в `develop`

  выполняет **тимлид**.

- После слияния релизной ветки:
    - релиз помечается тегом версии
    - релизная ветка удаляется

---

### Общие правила

- Прямые коммиты в `main` и `develop` запрещены.
- Ответственность за стабильность `develop` и `main` несёт тимлид.
- Каждый Pull Request должен соответствовать правилам Git Flow проекта.

---

## Процесс релиза

1. Создать ветку `release/X.Y.Z` от `develop`
2. Внести финальные правки:
    - исправление багов
    - обновление версий
    - правки документации
3. Слить `release/X.Y.Z` в `main`
4. Пометить релиз тегом `X.Y.Z`
5. Слить изменения из `main` обратно в `develop`

---

## Версионирование

Используется схема `MAJOR.MINOR.PATCH`.

Теги релизов:
- `0.1.0`
- `0.1.1`

## Данный Git Flow является обязательным для всех участников проекта.